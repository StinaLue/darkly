HOW WE FOUND IT:

1. Mainpage has several images, only one of them is a link to "darkly/?page=media&src=nsa". 
2. Click on the link, inspect image, see that image is displayed in an object HTML element.
3. Modify src parameter to random input -> input gets reflected in the "data" attribute of the HTML element "object".
4. Try to inject common scripts (<script>alert(1)</script>), gets reflected but doesn't execute. javascript:alert(1); gets filtered to alert(1).
5. Can't escape data attribute (probably htmlentities() PHP function is being used)
6. We find info on the data attribute of the object element : https://www.w3schools.com/tags/att_object_data.asp
7. Our script needs to be executed inside the data attribute, BUT attribute needs to be an URL!
8. Look for a way to get a script executed and at the same time be considered an URL, find one using data URIs (https://www.paladion.net/blogs/bypass-xss-filters-using-data-uris)
9. Try payload like : data:text/html;base64,PHNjcmlwdD5hbGVydCgiSGVsbG8iKTs8L3NjcmlwdD4= (PHNjcmlwdD5hbGVydCgiSGVsbG8iKTs8L3NjcmlwdD4= is <script>alert("Hello");</script> base64 encoded)
10. SUCCESS
