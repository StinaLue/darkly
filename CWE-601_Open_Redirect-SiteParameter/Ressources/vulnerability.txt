HOW WE FOUND IT:
When hovering over the logos of Facebook etc. we realized that the redirection to those pages is constructed as followed: http://darkly/index.php?page=redirect&site=facebook. We changed the URL behind site= to something random and got the flag.


PROBLEM:
This kind of redirection makes Phishing attacks easier. The website accepts user-controlled input that specifies a link to an external site and uses that link as a Redirect. 
People that trust this website and see and access the link of this website (but do not realize the redirect) could be tricked into thinking the redirect belongs to the trusted website. (http://example.com/example.php?url=http://malicious.example.com)

SOLUTION:
Use an "accept known good" input validation strategy, i.e., use a list of acceptable inputs that strictly conform to specifications. Reject any input that does not strictly conform to specifications, or transform it into something that does.

